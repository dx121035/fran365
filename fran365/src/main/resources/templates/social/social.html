<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.js"></script>
    <!-- ===============================================-->
    <!--    Favicons-->
    <!-- ===============================================-->
    <link rel="apple-touch-icon" sizes="180x180" href="../../assets/img/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../assets/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../assets/img/favicons/favicon-16x16.png">
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/img/favicons/favicon.ico">
    <link rel="manifest" href="../../assets/img/favicons/manifest.json">
    <meta name="msapplication-TileImage" content="../../assets/img/favicons/mstile-150x150.png">
    <meta name="theme-color" content="#ffffff">
    <script src="../../vendors/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="../../vendors/simplebar/simplebar.min.js"></script>
    <script src="../../assets/js/config.js"></script>


    <!-- ===============================================-->
    <!--    Stylesheets-->
    <!-- ===============================================-->
    <link href="../../vendors/glightbox/glightbox.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&amp;display=swap" rel="stylesheet">
    <link href="../../vendors/simplebar/simplebar.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css">
    <link href="../../assets/css/theme-rtl.min.css" type="text/css" rel="stylesheet" id="style-rtl">
    <link href="../../assets/css/theme.min.css" type="text/css" rel="stylesheet" id="style-default">
    <link href="../../assets/css/user-rtl.min.css" type="text/css" rel="stylesheet" id="user-style-rtl">
    <link href="../../assets/css/user.min.css" type="text/css" rel="stylesheet" id="user-style-default">
    <script>
        var phoenixIsRTL = window.config.config.phoenixIsRTL;
        if (phoenixIsRTL) {
            var linkDefault = document.getElementById('style-default');
            var userLinkDefault = document.getElementById('user-style-default');
            linkDefault.setAttribute('disabled', true);
            userLinkDefault.setAttribute('disabled', true);
            document.querySelector('html').setAttribute('dir', 'rtl');
        } else {
            var linkRTL = document.getElementById('style-rtl');
            var userLinkRTL = document.getElementById('user-style-rtl');
            linkRTL.setAttribute('disabled', true);
            userLinkRTL.setAttribute('disabled', true);
        }
    </script>

</head>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<body>

<div class="content">
    <div class="pb-10">
        <div class="row gy-3 gx-5 gx-xxl-6">
            <div class="col-lg-5 col-xl-4 d-none d-lg-block">
                <div class="card mb-5">
                    <div class="card-header hover-actions-trigger position-relative mb-7" style="min-height: 130px; ">
                        <div class="bg-holder rounded-top" style="background-image: linear-gradient(0deg, #000000 -3%, rgba(0, 0, 0, 0) 83%), url(../../assets/img/generic/59.png)">
                            <input class="d-none" id="upload-feed-cover-image" type="file" />
                            <label class="cover-image-file-input" for="upload-feed-cover-image"></label>
                            <div class="hover-actions end-0 bottom-0 pe-1 pb-2 text-white"><span class="fa-solid fa-camera me-2 overlay-icon"> </span></div>
                        </div>
                        <input class="d-none" id="upload-feed-porfile-picture" type="file" />
                        <label class="avatar avatar-4xl status-online feed-avatar-profile cursor-pointer" for="upload-feed-porfile-picture"><img class="rounded-circle img-thumbnail bg-white shadow-sm" src="../../assets/img/team/59.webp" width="200" alt="" /></label>
                    </div>
                    <div class="card-body" style="word-break: break-all">
                        <div class="row" >
                            <div class="col-12">
                                <div class="d-flex flex-wrap mb-3 align-items-center">
                                    <h3 class="me-2">Ansolo Lazinatov</h3><span class="fw-normal fs-0">u/hansolo</span>
                                </div>
                                <div class="mb-3">
                                    <div class="d-flex align-items-center flex-wrap">
                                        <div class="d-flex me-4 mb-2"><span class="fa-solid fa-user-group fs--2 me-2 me-lg-1 me-xl-2"></span>
                                            <h6 class="d-inline-block mb-0">1297 <span class="fw-semi-bold">Followers</span></h6>
                                        </div>
                                        <div class="d-flex mb-2"><span class="fa-solid fa-user-check fs--2 me-2 me-lg-1 me-xl-2"></span>
                                            <h6 class="d-block d-xl-inline-block mb-0">
                                                3971 <span class="fw-semi-bold">Following</span></h6>
                                        </div>
                                    </div>
                                </div>









                                <th:block th:each="list:${lists}">
                                    <button class="set-status" th:if="${list.status == '0'}" th:data-post-id="${list.id}" data-status="1">공개</button>
                                    <button class="set-status" th:if="${list.status == '1'}" th:data-post-id="${list.id}" data-status="0">비공개</button>


                                    <div class="listPictureRemove mb-0" th:id="'content-' + ${list.id}" th:data-id="${list.id}"  th:utext="${list.content}"></div>
                                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" th:data-status="${list.status}" th:data-id="${list.id}" th:data-content="${list.content}">수정</button></p>
                                <p class="text-700 mb-0"><div th:text="${#temporals.format(list.createDate, 'yyyy년 MM월 dd일 HH:mm')}"></div></p>


                                </th:block>

                            </div>
                        </div>
                    </div>
                </div>







                <div class="mb-8 mt-6">
                    <div class="d-flex flex-between-center pb-3 border-bottom border-dashed border-300">
                        <h3 class="mb-0">Messages<span class="text-700 ms-2 fw-normal">(97)</span></h3>
                        <div class="btn-reveal-trigger">
                            <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none d-flex btn-reveal" type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent"><span class="fas fa-ellipsis-h"></span></button>
                            <div class="dropdown-menu dropdown-menu-end py-2"><a class="dropdown-item" href="#!">Edit</a><a class="dropdown-item text-danger" href="#!">Delete</a><a class="dropdown-item" href="#!">Download</a><a class="dropdown-item" href="#!">Report abuse</a></div>
                        </div>
                    </div>
                    <div class="d-flex py-3 align-items-center border-bottom border-dashed">
                        <div class="me-2">
                            <div class="avatar avatar-m status-online ">
                                <img class="rounded-circle " src="../../assets/img/team/35.webp" alt="" />

                            </div>
                        </div><a class="text-decoration-none flex-1" href="../../apps/chat.html">
                        <h5>Stanly Drinkwater</h5>
                        <p class="text-700 fw-semi-bold fs--1 mb-0 lh-sm line-clamp-1">When you gonna pay me back, don’t leave me hanging</p>
                    </a>
                    </div>
                    <div class="d-flex py-3 align-items-center border-bottom border-dashed">
                        <div class="me-2">
                            <div class="avatar avatar-m status-online ">
                                <img class="rounded-circle " src="../../assets/img/team/30.webp" alt="" />

                            </div>
                        </div><a class="text-decoration-none flex-1" href="../../apps/chat.html">
                        <h5>Milind Mikuja</h5>
                        <p class="text-700 fw-semi-bold fs--1 mb-0 lh-sm line-clamp-1">But the mare fact that she said that makes</p>
                    </a>
                    </div>
                    <div class="d-flex py-3 align-items-center border-bottom border-dashed">
                        <div class="me-2">
                            <div class="avatar avatar-m status-online ">
                                <img class="rounded-circle avatar-placeholder" src="../../assets/img/team/avatar.webp" alt="" />

                            </div>
                        </div><a class="text-decoration-none flex-1" href="../../apps/chat.html">
                        <h5>Josef Stravinsky</h5>
                        <p class="text-700 fw-semi-bold fs--1 mb-0 lh-sm line-clamp-1">Oi Cult.</p>
                    </a>
                    </div>
                    <div class="d-flex py-3 align-items-center border-bottom border-dashed">
                        <div class="me-2">
                            <div class="avatar avatar-m status-online ">
                                <img class="rounded-circle " src="../../assets/img/team/59.webp" alt="" />

                            </div>
                        </div><a class="text-decoration-none flex-1" href="../../apps/chat.html">
                        <h5>Martina scorcese</h5>
                        <p class="text-700 fw-semi-bold fs--1 mb-0 lh-sm line-clamp-1">Thanks for that. Sincerely.</p>
                    </a>
                    </div>
                    <div class="d-flex py-3 align-items-center border-bottom border-dashed">
                        <div class="me-2">
                            <div class="avatar avatar-m status-online ">
                                <img class="rounded-circle " src="../../assets/img/team/57.webp" alt="" />

                            </div>
                        </div><a class="text-decoration-none flex-1" href="../../apps/chat.html">
                        <h5>Meekona Zikon</h5>
                        <p class="text-700 fw-semi-bold fs--1 mb-0 lh-sm line-clamp-1">I am Outside, Come here, Lets smoke...</p>
                    </a>
                    </div>
                </div>





            </div>
            <div class="col-lg-7 col-xl-8">



                <div class="card d-flex flex-column mb-5">
                    <form action="/social/create" method="post">
                        <input type="hidden" id="content-id" name="contentId">
                        <textarea type="text" id="summernote" name="content"></textarea>
                        <input type="submit" value="등록">
                    </form>
                </div>



                <div class="mb-9">


                        <br>

                        <br>


                        <br>



                    <th:block th:each="detail:${details}">
                    <div class="mb-5">
                        <div class="card mb-4">
                            <div class="card-body p-3 p-sm-4">



                                <div class="border-bottom mb-3">
                                    <div class="d-flex align-items-center mb-3"><a href="../../apps/social/profile.html">
                                        <div class="avatar avatar-xl  me-2">
                                            <img class="rounded-circle " src="../../assets/img/team/59.webp" alt="" />

                                        </div>
                                    </a>
                                        <div class="flex-1"><a class="fw-bold mb-0 text-black" href="../../apps/social/profile.html">[[${detail.username}]]</a>
                                            <p class="fs--2 mb-0 text-600 fw-semi-bold"><div th:text="${#temporals.format(detail.createDate, 'yyyy년 MM월 dd일 HH:mm')}"></div><span class="fa-solid fa-circle text-300" data-fa-transform="shrink-10 down-2"></span>대한민국<span class="fa-solid fa-circle text-300" data-fa-transform="shrink-10 down-2"></span><span class="fa-solid fa-earth-americas text-900"></span>
                                            </p>
                                        </div>
                                        <div class="btn-reveal-trigger">
                                            <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none d-flex btn-reveal" type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent"><span class="fas fa-ellipsis-h"></span></button>
                                            <div class="dropdown-menu dropdown-menu-end py-2"><a class="dropdown-item" href="#!">Edit</a><a class="dropdown-item text-danger" href="#!">Delete</a><a class="dropdown-item" href="#!">Download</a><a class="dropdown-item" href="#!">Report abuse</a></div>
                                        </div>
                                    </div>

                                    [(${detail.content})]
                                </div>




                                <div class="d-flex">
                                    <button class="btn btn-link p-0 me-3 fs--2 fw-bolder" type="button"><span class="fa-solid fa-heart me-1"></span>345 Likes
                                    </button>
                                    <button class="btn btn-link text-900 p-0 fs--2 me-3 fw-bolder" type="button"><span class="fa-solid fa-comment me-1"></span>45 Comments
                                    </button>
                                </div>
                            </div>
                            <div class="bg-100 border-top p-3 p-sm-4">

                                <div class="d-flex align-items-start">
                                    <!--comment-->

                                    <div class="avatar avatar-m  me-2">
                                        <img class="rounded-circle " src="../../assets/img/team/23.webp" alt="" />
                                    </div>
                                    <th:block th:each="comment: ${detail.commentList}">
                                    <div class="flex-1">
                                        <div class="d-flex align-items-center">[[${comment.username}]]<span class="text-600 fw-semi-bold fs--2 ms-2">[[${#temporals.format(comment.createDate, 'yyyy년 MM월 dd일 HH:mm')}]]</span></div>
                                        <p class="mb-0">[[${comment.content}]]</p>
                                        <button class="btn btn-link p-0 text-900 fw-bolder mb-2" type="button"><span class="fa-solid fa-reply fs--2 me-1"></span><span class="fw-bold fs--2">Reply</span></button>
                                    </th:block>
                                        <!--comment2-->

                                        <div class="d-flex align-items-start mb-3">
                                            <div class="avatar avatar-m  me-2">
                                                <img class="rounded-circle " src="../../assets/img/team/62.webp" alt="" />
                                            </div>
                                            <div class="flex-1">
                                                <div class="d-flex align-items-center">Zingko Kudobum<span class="text-600 fw-semi-bold fs--2 ms-2">5 mins ago</span></div>
                                                <p class="mb-0">I am so clever that sometimes I don't understand a single word of what I am saying.</p>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <!--input-->
                                <div class="d-flex align-items-center">
                                    <div class="avatar avatar-m  me-2">
                                        <img class="rounded-circle " src="../../assets/img/team/59.webp" alt="" />
                                    </div>
                                    <div class="flex-1">
                                        <form class="comment-form" action="/comment/create" method="post">
                                            <textarea class="form-control" type="text" name="content" placeholder="댓글 추가"></textarea>
                                            <input type="hidden" class="post-id" name="id" th:value="${detail.id}" data-post-id="${detail.id}" />
                                            <input type="hidden" name="username" value="${detail.username}">
                                            <input type="submit" class="create-comment btn btn-primary" value="등록">
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </th:block>





                    </div>



                </div>
                <div class="text-center"><a class="btn btn-link fs-0 p-0" href="#!">Load more</a></div>
            </div>
        </div>
    </div>




<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" style="height: 80%;">
        <div class="modal-content">
            <form action="/social/update" method="post">
                <input type="hidden" id="post-id" name="id" value="">
                <input type="hidden" id="status" name="status" value="">
            <div class="modal-header">
                <h3 class="modal-title fs-5" id="exampleModalLabel">게시물 수정</h3>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">

                    <div class="mb-3">
                        <label  class="col-form-label">Message:</label>
                        <textarea type="text" id="summernote2" name="content"></textarea>
                    </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

                <input type="submit" value="수정" class="btn btn-primary"></input>
            </div>
            </form>
        </div>
    </div>
</div>






<script>
    $(document).ready(function() {
        $('#summernote').summernote({
            tabsize: 2,
            height: 200,
        });

        $(".create-comment").click(function () {

            var postId = $(this).closest('.comment-form').find('.post-id').data('post-id');
            var commentContent = $(this).closest('.comment-form').find('textarea[name="content"]').val();
            console.log('postId:', postId);
            console.log('commentContent:', commentContent);

            $.ajax({
                url: '/comment/create',
                method: 'POST',
                data: {
                    id: postId,
                    content: commentContent
                },
                success: function (response) {
                    alert('댓글이 성공적으로 추가되었습니다.');
                    location.reload();
                },
                error: function (err) {
                    console.error(err);
                    alert('댓글이 등록되었습니다.');
                }
            });
        });

        $(".set-status").click(function() {
            var postId = $(this).data('post-id');
            var status = $(this).data('status');
            $.ajax({
                url: '/social/feedStatus',
                method: 'POST',
                data: {
                    postId: postId,
                    status: status
                },
                success: function(response) {
                    alert('게시물 상태가 성공적으로 업데이트되었습니다.');
                    location.reload();
                },
                error: function(err) {
                    console.error(err);
                    alert('게시물 상태 업데이트 중 오류가 발생했습니다.');
                }
            });
        });

    const exampleModal = document.getElementById('exampleModal');
    if (exampleModal) {
        exampleModal.addEventListener('show.bs.modal', event => {
            const button = event.relatedTarget; // Button that triggered the modal
            const content = button.getAttribute('data-content'); // Extract the 'content' from the data attribute
            const modalTitle = exampleModal.querySelector('.modal-title');
            const postId = button.getAttribute('data-id'); // Assuming 'data-id' contains the post id
            const modalPostIdInput = exampleModal.querySelector('#post-id');  // Get the 'id' input field
            const status = button.getAttribute('data-status');
            const modalStatusInput = exampleModal.querySelector('#status');

            modalTitle.textContent = ` 게시물 수정`;
            modalPostIdInput.value = postId;
            modalStatusInput.value = status;
            $('#summernote2').summernote('code', content);
        });
    }

    $('#summernote2').summernote({
        tabsize: 2,
        height: 200,
    });




    });



</script>

<script>
    window.onload = function() {
        var contents = document.querySelectorAll('.listPictureRemove');
        contents.forEach(function(content) {
                var div = document.createElement('div');
                div.innerHTML = content.innerHTML;
                var images = div.getElementsByTagName('img');
                while(images.length > 0) {
                    images[0].parentNode.removeChild(images[0]);
                }
                content.innerHTML = div.innerHTML;
        });
    };
</script>

<!-- ===============================================-->
<!--    JavaScripts-->
<!-- ===============================================-->
<script src="../../vendors/popper/popper.min.js"></script>
<script src="../../vendors/bootstrap/bootstrap.min.js"></script>
<script src="../../vendors/anchorjs/anchor.min.js"></script>
<script src="../../vendors/is/is.min.js"></script>
<script src="../../vendors/fontawesome/all.min.js"></script>
<script src="../../vendors/lodash/lodash.min.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=window.scroll"></script>
<script src="../../vendors/list.js/list.min.js"></script>
<script src="../../vendors/feather-icons/feather.min.js"></script>
<script src="../../vendors/dayjs/dayjs.min.js"></script>
<script src="../../vendors/glightbox/glightbox.min.js"> </script>
<script src="../../assets/js/phoenix.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>

</body>
</html>